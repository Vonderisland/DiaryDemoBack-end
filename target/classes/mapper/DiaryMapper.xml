<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.demo.server.dao.DiaryDao">

    <insert id="insertDiary" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO diary(title, description, url, eventTime, createTime, updateTime)
        VALUES (#{title}, #{description}, #{url}, #{eventTime}, #{createTime}, #{updateTime})
    </insert>

    <update id="updateDiary">
        UPDATE diary SET
        title = #{diary.title},
        description = #{diary.description},
        url = #{diary.url},
        eventTime = #{diary.eventTime},
        updateTime = #{diary.updateTime}
        WHERE id = #{id}
    </update>

    <update id="deleteDiary">
        UPDATE diary SET
        isDeleted = TRUE
        WHERE id = #{id}
    </update>

    <select id="selectDiaries" resultType="com.demo.server.bean.Diary">
        SELECT * FROM diary
        WHERE isDeleted = FALSE and eventTime &lt; #{timeCursor}
        ORDER BY eventTime DESC, updateTime DESC LIMIT #{size}
    </select>

    <select id="selectAllDiaries" resultType="com.demo.server.bean.Diary">
        SELECT * FROM diary
        WHERE isDeleted = FALSE
        ORDER BY eventTime DESC, updateTime
    </select>
</mapper>